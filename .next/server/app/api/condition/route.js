(()=>{var e={};e.id=481,e.ids=[481],e.modules={6330:e=>{"use strict";e.exports=require("@prisma/client")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1427:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>u,serverHooks:()=>g,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>p});var n={};r.r(n),r.d(n,{POST:()=>d});var o=r(2706),a=r(8203),i=r(5994),s=r(2708),l=r(9187);async function d(e){try{let{bridgeCondition:t="",deckCond:r="",superstructureCond:n="",substructureCond:o="",channelCond:a="",culvertCond:i="",structuralEval:d="",deckGeometryEval:u="",underclearanceEval:c="",waterwayEval:p="",apprRoadEval:g={min:0,max:0},postingEval:m={min:0,max:0},lowestRating:v={min:0,max:0},bounds:x=null}=await e.json();console.log("Received bounds:",x);let h={};if(t&&(h.bridgeCondition=t),r&&(h.deckCond=r),n&&(h.superstructureCond=n),o&&(h.substructureCond=o),a&&(h.channelCond=a),i&&(h.culvertCond=i),d&&(h.structuralEval=d),u&&(h.deckGeometryEval=u),c&&(h.underclearanceEval=c),p&&(h.waterwayEval=p),(g.min||g.max)&&(h.apprRoadEval={gte:g.min||void 0,lte:g.max||void 0}),(m.min||m.max)&&(h.postingEval={gte:m.min||void 0,lte:m.max||void 0}),(v.min||v.max)&&(h.lowestRating={gte:v.min||void 0,lte:v.max||void 0}),x&&Array.isArray(x)&&4===x.length){let[e,t,r,n]=x;t=Math.round(1e6*t),n=Math.round(1e6*n),e=Math.round(1e6*e),r=Math.round(1e6*r),console.log(`Filtering by viewport bounds: lat(${t} - ${n}), long(${e} - ${r})`),h.Bridge={lat:{gte:t,lte:n},long:{gte:e,lte:r}}}let w=(await s.A.condition.findMany({where:h,include:{Bridge:{select:{structureNumber:!0,lat:!0,long:!0,location:!0,yearBuilt:!0}}}})).map(e=>({id:e.id,structureNumber:e.structureNumber,bridgeCondition:e.bridgeCondition,deckCond:e.deckCond,superstructureCond:e.superstructureCond,substructureCond:e.substructureCond,channelCond:e.channelCond,culvertCond:e.culvertCond,structuralEval:e.structuralEval,deckGeometryEval:e.deckGeometryEval,underclearanceEval:e.underclearanceEval,waterwayEval:e.waterwayEval,apprRoadEval:e.apprRoadEval,postingEval:e.postingEval,lowestRating:e.lowestRating,lat:e.Bridge.lat,long:e.Bridge.long,location:e.Bridge.location,yearBuilt:e.Bridge.yearBuilt}));return console.log(`Conditions found: ${w.length}`),l.NextResponse.json(w,{status:200})}catch(e){return console.error("Error fetching conditions:",e),l.NextResponse.json({message:"Failed to fetch conditions",error:e instanceof Error?e.message:"Unknown error"},{status:500})}finally{await s.A.$disconnect()}}let u=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/condition/route",pathname:"/api/condition",filename:"route",bundlePath:"app/api/condition/route"},resolvedPagePath:"/Users/ahmadhawamdah/Documents/map9/src/app/api/condition/route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:c,workUnitAsyncStorage:p,serverHooks:g}=u;function m(){return(0,i.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:p})}},6487:()=>{},8335:()=>{},2708:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(6330);let o=globalThis.prismaGlobal??new n.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[989,452],()=>r(1427));module.exports=n})();